<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta name="description" content="Gahan Khatiwoda's 100-Days-Challenge with enhanced visitor tracking analytics">
<meta name="keywords" content="education, computer science, SEE 2082, practice sets, visitor tracking">
<meta name="author" content="Gahan Khatiwoda">

    <title>GAHAN KHATIWODA OFFICIAL - Enhanced 100-Days-Challenge</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">

<link rel="icon" href="favicon.png" type="image/x-icon">
    
    <script>
    // Enable Google debug
    window.googleDebug = true;
    
    // Log Google Identity status
    setInterval(() => {
        if (typeof google !== 'undefined') {
            console.log('Google API loaded:', !!google.accounts);
        } else {
            console.log('Google API not loaded yet');
        }
    }, 2000);
    </script>

    
</head>
<body>

<!-- Loading Overlay -->
<div id="loadingOverlay" class="loading-overlay">
    <div class="loading-spinner"></div>
    <div style="color: white; margin-top: 20px;">Initializing Enhanced Tracking System...</div>
    <div id="loadingProgress" style="color: #aaa; font-size: 14px; margin-top: 10px;"></div>
</div>

<!-- Toast Container -->
<div class="toast-container" id="toastContainer"></div>

<!-- Top Navigation -->
<div class="top-nav">
    <div class="logo-container">
        <div class="logo">GAHAN KHATIWODA</div>
        <div style="color: var(--gray); font-size: 12px;">Enhanced Visitor Tracking</div>
    </div>
    
    <div class="nav-controls">
        <button class="nav-btn" onclick="UI.showPrivacyModal()">
            <i class="fas fa-shield-alt"></i>
            <span>Privacy</span>
        </button>
        <button class="nav-btn" onclick="UI.showAnalyticsModal()">
            <i class="fas fa-chart-bar"></i>
            <span>Analytics</span>
        </button>
        <button class="nav-btn primary" onclick="UI.toggleDarkMode()">
            <i class="fas fa-moon"></i>
            <span>Theme</span>
        </button>
    </div>
</div>

<!-- Visitor Dashboard (Smaller for Mobile) -->
<div class="visitor-dashboard">
    <div class="dashboard-content">
        <div class="dashboard-item">
            <div class="dashboard-icon" style="color: #00ff00;">
                <i class="fas fa-users"></i>
            </div>
            <div class="dashboard-text">
                <div class="dashboard-value" id="totalVisitors">0000</div>
                <div class="dashboard-label">Total</div>
            </div>
        </div>
        
        <div class="dashboard-item">
            <div class="dashboard-icon" style="color: #4285F4;">
                <i class="fas fa-user-check"></i>
            </div>
            <div class="dashboard-text">
                <div class="dashboard-value" id="uniqueVisitors">0000</div>
                <div class="dashboard-label">Unique</div>
            </div>
        </div>
        
        <div class="dashboard-item">
            <div class="dashboard-icon" style="color: #EA4335;">
                <i class="fas fa-circle"></i>
            </div>
            <div class="dashboard-text">
                <div class="dashboard-value" id="liveVisitors">00</div>
                <div class="dashboard-label">Live</div>
            </div>
        </div>
    </div>
</div>

<!-- Main Container -->
<div class="main-container">
    <!-- Login Screen -->
    <div id="loginScreen">
        <div class="section-header">
            <h1 class="section-title">100-DAYS-CHALLENGE</h1>
            <h2 class="section-subtitle">Computer Science • SEE 2082</h2>
            <p style="color: var(--gray); margin-top: 20px; font-size: 18px;">
                Complete Subjective & Objective Practice Sets with Enhanced Analytics
            </p>
        </div>
        
        <div class="login-form">
            <div class="form-tabs">
                <button class="tab-btn active" onclick="UI.switchTab('traditional')">
                    <i class="fas fa-user-lock"></i> Traditional Login
                </button>
                <button class="tab-btn" onclick="UI.switchTab('google')">
                    <i class="fab fa-google"></i> Google Login
                </button>
            </div>
            
            <!-- Traditional Login Tab -->
            <div id="traditionalTab" class="tab-content active">
                <div class="form-group">
                    <label for="username">
                        <span>Username / Email</span>
                        <span style="font-size: 12px; color: var(--gray);">
                            <i class="fas fa-info-circle"></i> Contact admin for credentials
                        </span>
                    </label>
                    <div class="input-wrapper">
                        <i class="fas fa-user input-icon"></i>
                        <input type="text" id="username" class="form-input with-icon" 
                               placeholder="Enter your username or email" 
                               autocomplete="username">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="password">Password</label>
                    <div class="input-wrapper">
                        <i class="fas fa-key input-icon"></i>
                        <input type="password" id="password" class="form-input with-icon" 
                               placeholder="Enter your password" 
                               autocomplete="current-password">
                        <button type="button" class="password-toggle" onclick="UI.togglePassword()">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <div class="form-group" style="display: flex; align-items: center; gap: 10px;">
                    <input type="checkbox" id="rememberMe" style="width: auto;">
                    <label for="rememberMe" style="margin: 0; font-weight: normal;">Remember me for 24 hours</label>
                </div>
                
                <button class="login-btn" onclick="Auth.loginUser()" id="loginBtn">
                    <i class="fas fa-sign-in-alt"></i>
                    <span>Login to Access Content</span>
                </button>
                
                <div id="errorMessage" style="color: var(--accent); margin-top: 15px; text-align: center; display: none;">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span id="errorText">Invalid username or password. Please try again.</span>
                </div>
            </div>
            
       <!-- Google Login Tab -->
<div id="googleTab" class="tab-content">
    <div class="google-signin-container">
        <p style="margin-bottom: 20px; color: var(--gray);">
            Sign in with your Google account for faster access
        </p>
        
        <!-- Add debug information -->
        <div id="googleDebug" style="display: none; margin-bottom: 15px; padding: 10px; background: #f0f0f0; border-radius: 5px; font-size: 12px; color: #666;">
            <p>Google Sign-In Status: <span id="googleStatus">Checking...</span></p>
        </div>
        
        <div id="g_id_onload"
             data-client_id="789365890180-30fpjid0955op8rldf1js02br0t7jql3.apps.googleusercontent.com"
             data-context="signin"
             data-ux_mode="popup"
             data-callback="Auth.handleCredentialResponse"
             data-auto_prompt="false"
             data-itp_support="true"
             data-login_uri="https://yourdomain.com" <!-- Add your domain -->
             data-auto_select="false">
        </div>
        
        <div class="g_id_signin"
             data-type="standard"
             data-shape="rectangular"
             data-theme="outline"
             data-text="signin_with"
             data-size="large"
             data-logo_alignment="left"
             data-width="100%">
        </div>
        
        <!-- Fallback manual button -->
        <button id="manualGoogleBtn" style="display: none; background: #4285F4; color: white; border: none; padding: 12px 24px; border-radius: 4px; cursor: pointer; width: 100%; margin-top: 10px; font-size: 16px;">
            <i class="fab fa-google"></i> Sign in with Google
        </button>
        
        <div id="googleUserInfo" style="margin-top: 30px; display: none;">
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: center;">
                <img id="googleAvatar" style="width: 60px; height: 60px; border-radius: 50%; margin: 0 auto 15px; display: block;" src="" alt="Profile">
                <h3 id="googleName" style="color: var(--primary); margin-bottom: 5px;"></h3>
                <p id="googleEmail" style="color: var(--gray); font-family: 'Courier New'; margin-bottom: 20px;"></p>
                
                <button onclick="Auth.loginWithGoogle()" style="background: var(--success); color: white; border: none; padding: 12px 30px; border-radius: 8px; cursor: pointer; margin: 5px; font-size: 16px; width: 100%;">
                    <i class="fas fa-check-circle"></i> Continue with this Google Account
                </button>
                
                <button onclick="Auth.googleLogout()" style="background: transparent; color: var(--gray); border: 1px solid #ddd; padding: 8px 20px; border-radius: 5px; cursor: pointer; margin: 5px; font-size: 14px; width: 100%;">
                    <i class="fas fa-sync"></i> Use different account
                </button>
                
                <div style="margin-top: 15px; font-size: 12px; color: #666;">
                    <i class="fas fa-info-circle"></i> By continuing, you agree to share your name and email
                </div>
            </div>
        </div>
        
        <!-- Loading indicator -->
        <div id="googleLoading" style="display: none; text-align: center; padding: 20px;">
            <div class="loading-spinner" style="width: 30px; height: 30px; margin: 0 auto 10px;"></div>
            <p style="color: var(--gray);">Processing Google Sign-In...</p>
        </div>
    </div>
    
    <!-- Instructions -->
    <div style="margin-top: 25px; padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #4285F4;">
        <h4 style="color: #4285F4; margin-bottom: 10px; font-size: 14px;">
            <i class="fas fa-question-circle"></i> Google Sign-In Help
        </h4>
        <ul style="color: var(--gray); font-size: 12px; padding-left: 20px; margin: 0;">
            <li>Make sure you're using a modern browser (Chrome, Firefox, Edge)</li>
            <li>Allow pop-ups for this site if prompted</li>
            <li>If the button doesn't appear, refresh the page</li>
            <li>Contact admin if your Google account is not authorized</li>
        </ul>
    </div>
</div>
        <!-- Features Section -->
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-book-open"></i>
                </div>
                <h3 class="feature-title">Odd Days Sets</h3>
                <p style="color: var(--gray);">Comprehensive subjective question bank with detailed solutions</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-book"></i>
                </div>
                <h3 class="feature-title">Even Days Sets</h3>
                <p style="color: var(--gray);">Advanced practice questions with step-by-step explanations</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-check-double"></i>
                </div>
                <h3 class="feature-title">Objective Sets</h3>
                <p style="color: var(--gray);">MCQ and quick review with instant feedback system</p>
            </div>
        </div>
    </div>
    
    <!-- Success Screen -->
    <div class="success-screen" id="successScreen">
        <div class="section-header">
            <div class="success-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h1 class="section-title">Access Granted!</h1>
            <h2 class="section-subtitle">Welcome to Enhanced Learning Platform</h2>
        </div>
        
        <div class="user-info-card">
            <h3 style="color: var(--primary); margin-bottom: 20px;">
                <i class="fas fa-user-circle"></i> User Information
            </h3>
            <div class="user-info-row">
                <span style="font-weight: 600;">Username:</span>
                <span id="displayUsername">Loading...</span>
            </div>
            <div class="user-info-row">
                <span style="font-weight: 600;">Email:</span>
                <span id="displayEmail">Loading...</span>
            </div>
            <div class="user-info-row">
                <span style="font-weight: 600;">Login Method:</span>
                <span id="displayMethod">Loading...</span>
            </div>
            <div class="user-info-row">
                <span style="font-weight: 600;">Session Started:</span>
                <span id="displaySessionTime">Loading...</span>
            </div>
            <div class="user-info-row">
                <span style="font-weight: 600;">Your Visitor ID:</span>
                <span id="displayVisitorId" style="font-family: 'Courier New'; color: var(--primary);">Loading...</span>
            </div>
        </div>
        
        <p style="color: var(--gray); margin: 30px 0; font-size: 16px;">
            <i class="fas fa-sync-alt"></i> Your progress is automatically saved. Choose content to begin:
        </p>
        
        <div class="content-grid">
            <div class="content-card odd" onclick="UI.goToContent('odd')">
                <div style="font-size: 40px; color: #FF9800; margin-bottom: 15px;">
                    <i class="fas fa-file-alt"></i>
                </div>
                <h3 style="color: var(--dark); margin-bottom: 10px;">ODD-DAYS SETS</h3>
                <p style="color: var(--gray); font-size: 14px;">Subjective practice with solutions</p>
                <div style="margin-top: 15px; color: #FF9800; font-size: 12px;">
                    <i class="fas fa-arrow-right"></i> Click to access
                </div>
            </div>
            
            <div class="content-card even" onclick="UI.goToContent('even')">
                <div style="font-size: 40px; color: #2196F3; margin-bottom: 15px;">
                    <i class="fas fa-book"></i>
                </div>
                <h3 style="color: var(--dark); margin-bottom: 10px;">EVEN-DAYS SETS</h3>
                <p style="color: var(--gray); font-size: 14px;">Advanced questions & explanations</p>
                <div style="margin-top: 15px; color: #2196F3; font-size: 12px;">
                    <i class="fas fa-arrow-right"></i> Click to access
                </div>
            </div>
            
            <div class="content-card obj" onclick="UI.goToContent('obj')">
                <div style="font-size: 40px; color: #9C27B0; margin-bottom: 15px;">
                    <i class="fas fa-check-double"></i>
                </div>
                <h3 style="color: var(--dark); margin-bottom: 10px;">OBJECTIVE SETS</h3>
                <p style="color: var(--gray); font-size: 14px;">MCQ practice with instant feedback</p>
                <div style="margin-top: 15px; color: #9C27B0; font-size: 12px;">
                    <i class="fas fa-arrow-right"></i> Click to access
                </div>
            </div>
        </div>
        
        <div style="display: flex; gap: 15px; justify-content: center; margin-top: 40px;">
            <button onclick="Auth.logout()" style="background: var(--accent); color: white; border: none; padding: 12px 30px; border-radius: 8px; cursor: pointer; font-size: 16px; display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
            <button onclick="UI.showSessionInfo()" style="background: var(--primary); color: white; border: none; padding: 12px 30px; border-radius: 8px; cursor: pointer; font-size: 16px; display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-info-circle"></i> Session Info
            </button>
        </div>
    </div>
</div>

<!-- Analytics Modal -->
<div id="analyticsModal" class="analytics-modal">
    <div class="modal-content">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
            <h2 style="color: var(--primary);">
                <i class="fas fa-chart-bar"></i> Advanced Analytics
            </h2>
            <button onclick="UI.hideAnalyticsModal()" style="background: none; border: none; font-size: 24px; color: var(--gray); cursor: pointer;">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="modal-tabs">
            <button class="modal-tab active" onclick="Analytics.switchTab('overview')">
                <i class="fas fa-tachometer-alt"></i> Overview
            </button>
            <button class="modal-tab" onclick="Analytics.switchTab('realtime')">
                <i class="fas fa-bolt"></i> Real-Time
            </button>
            <button class="modal-tab" onclick="Analytics.switchTab('geography')">
                <i class="fas fa-globe"></i> Geography
            </button>
            <button class="modal-tab" onclick="Analytics.switchTab('devices')">
                <i class="fas fa-mobile-alt"></i> Devices
            </button>
        </div>
        
        <!-- Overview Tab -->
        <div id="overviewTab" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="modalTotal">0</div>
                    <div class="stat-label">Total Visitors</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="modalUnique">0</div>
                    <div class="stat-label">Unique Visitors</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="modalLive">0</div>
                    <div class="stat-label">Live Now</div>
                </div>
            </div>
        </div>
        
        <!-- Real-Time Tab -->
        <div id="realtimeTab" class="tab-content">
            <h4 style="color: var(--dark); margin-bottom: 15px;">
                <i class="fas fa-users"></i> Live Visitors
            </h4>
            <div id="liveVisitorsList" style="max-height: 300px; overflow-y: auto;">
                <div style="text-align: center; padding: 40px; color: var(--gray);">
                    <i class="fas fa-sync fa-spin" style="font-size: 30px; margin-bottom: 15px;"></i>
                    <p>Loading real-time data...</p>
                </div>
            </div>
        </div>
        
        <!-- Geography Tab -->
        <div id="geographyTab" class="tab-content">
            <h4 style="color: var(--dark); margin-bottom: 15px;">
                <i class="fas fa-map-marker-alt"></i> Visitor Locations
            </h4>
            <div id="countryList" style="max-height: 300px; overflow-y: auto;">
                <div style="text-align: center; padding: 40px; color: var(--gray);">
                    <i class="fas fa-globe-americas" style="font-size: 30px; margin-bottom: 15px;"></i>
                    <p>Geographic data loading...</p>
                </div>
            </div>
        </div>
        
        <!-- Devices Tab -->
        <div id="devicesTab" class="tab-content">
            <h4 style="color: var(--dark); margin-bottom: 15px;">
                <i class="fas fa-laptop"></i> Device Distribution
            </h4>
            <div id="deviceStats">
                <div style="text-align: center; padding: 40px; color: var(--gray);">
                    <i class="fas fa-mobile-alt" style="font-size: 30px; margin-bottom: 15px;"></i>
                    <p>Device statistics loading...</p>
                </div>
            </div>
        </div>
        
        <div style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #e9ecef;">
            <p style="color: var(--gray); font-size: 12px; text-align: center;">
                <i class="fas fa-shield-alt"></i> Data updated every 30 seconds • Last updated: <span id="lastUpdateTime">Just now</span>
            </p>
        </div>
    </div>
</div>

<!-- Privacy Modal -->
<div id="privacyModal" class="privacy-modal">
    <div class="privacy-content">
        <h2 style="color: var(--primary); margin-bottom: 20px;">
            <i class="fas fa-shield-alt"></i> Privacy & Data Collection Notice
        </h2>
        
        <div style="margin-bottom: 25px;">
            <h4 style="color: var(--dark); margin-bottom: 10px;">What We Collect:</h4>
            <ul style="color: var(--gray); line-height: 1.8; padding-left: 20px;">
                <li><strong>Session Data:</strong> Anonymous session identifiers</li>
                <li><strong>Technical Information:</strong> Browser type, device type, screen resolution</li>
                <li><strong>Usage Data:</strong> Pages visited, time spent, interactions</li>
                <li><strong>Location Data:</strong> Country-level location (no precise GPS)</li>
                <li><strong>Login Information:</strong> Only when you explicitly log in</li>
            </ul>
        </div>
        
        <div style="margin-bottom: 25px;">
            <h4 style="color: var(--dark); margin-bottom: 10px;">What We <strong>DO NOT</strong> Collect:</h4>
            <ul style="color: var(--gray); line-height: 1.8; padding-left: 20px;">
                <li>Personal identification without consent</li>
                <li>Precise location data</li>
                <li>Sensitive personal information</li>
                <li>Cross-site tracking data</li>
                <li>Persistent cookies without consent</li>
            </ul>
        </div>
        
        <div style="margin-bottom: 25px;">
            <h4 style="color: var(--dark); margin-bottom: 10px;">Data Usage:</h4>
            <p style="color: var(--gray); line-height: 1.6;">
                We use this data exclusively to improve the learning experience, 
                analyze content effectiveness, and prevent abuse. All data is 
                stored securely and anonymized where possible.
            </p>
        </div>
        
        <div style="display: flex; gap: 15px; margin-top: 30px;">
            <button onclick="UI.acceptPrivacy()" style="background: var(--success); color: white; border: none; padding: 15px 30px; border-radius: 8px; cursor: pointer; font-size: 16px; flex: 1;">
                <i class="fas fa-check"></i> I Understand & Accept
            </button>
            <button onclick="UI.showPrivacySettings()" style="background: var(--primary); color: white; border: none; padding: 15px 30px; border-radius: 8px; cursor: pointer; font-size: 16px; flex: 1;">
                <i class="fas fa-cog"></i> Privacy Settings
            </button>
            <button onclick="UI.hidePrivacyModal()" style="background: transparent; color: var(--gray); border: 1px solid #ddd; padding: 15px 20px; border-radius: 8px; cursor: pointer; font-size: 16px;">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <p style="color: var(--gray); font-size: 12px; margin-top: 20px; text-align: center;">
            <i class="fas fa-info-circle"></i> You can change privacy settings anytime from the top navigation
        </p>
    </div>
</div>

<!-- Footer -->
<footer style="color: white; text-align: center; padding: 30px; opacity: 0.8;">
    <p style="margin-bottom: 10px;">© 2023 Gahan Khatiwoda Official • Enhanced Visitor Tracking System v2.0</p>
    <p style="font-size: 14px;">
        <i class="fas fa-heart" style="color: #ff4444;"></i> 
        Built with advanced analytics & privacy-first approach
    </p>
</footer>

<!-- Google Identity Services -->
<script src="https://accounts.google.com/gsi/client" async defer></script>

<!-- Module Imports -->
<script src="modules/utils.js"></script>
<script src="modules/tracking.js"></script>
<script src="modules/auth.js"></script>
<script src="modules/ui.js"></script>
<script src="modules/analytics.js"></script>
<script src="app.js"></script>

</body>
</html>